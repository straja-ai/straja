server:
  addr: ":8080"
  read_header_timeout: "5s"
  read_timeout: "30s"
  write_timeout: "120s"
  idle_timeout: "60s"
  max_request_body_bytes: 2097152        # 2 * 1024 * 1024
  max_non_stream_response_bytes: 4194304 # 4 * 1024 * 1024
  max_in_flight_requests: 200
  upstream_timeout: "60s"

default_provider: "openai_default"

providers:
  openai_default:
    type: "openai"
    base_url: "https://api.openai.com/v1"
    api_key_env: "OPENAI_API_KEY"
  openai_production:
    type: "openai"
    base_url: "https://api.openai.com/v1"
    api_key_env: "OPENAI_API_KEY"

projects:
  - id: "default"
    provider: "openai_default"
    api_keys:
      - "local-dev-key-123"
  - id: "production"
    provider: "openai_production"
    api_keys:
      - "local-dev-key-124"

logging:
  activation_level: "redacted"   # metadata | redacted | full

policy:
  banned_words: "redact" #  | redact| ignore | block | log
  banned_words_list:
    - "blocked_test"
    - "foo_bar"
    - "forbidden"

  pii: "redact"
  pii_entities:
    email: true
    phone: true
    credit_card: true
    iban: true
    tokens: true

  injection: "block"
  prompt_injection: "block"
  jailbreak: "block"
  toxicity: "log"

intelligence:
  enabled: true
  license_key: "STRAJA-FREE-XXX-XXX-XXXXX"
  license_server_url: "https://straja.ai/api/license/validate"
  bundle_cache_dir: "/var/lib/straja/bundles"
  license_key_env: "STRAJA_LICENSE_KEY"
  auto_update: true
  update_check_interval: "6h"

intel:
  strajaguard_v1:
    enabled: true
    license_server_base_url: "https://straja.ai"
    request_timeout_seconds: 300
    bundle_download_timeout_seconds: 300
    intel_dir: "/var/lib/straja/intel"
    version_file: "version"

security:
  enabled: true
  bundle_dir: "/var/lib/straja/bundles/strajaguard_v1"
  seq_len: 256
  prompt_injection:
    regex_enabled: true
    ml_enabled: true
    ml_warn_threshold: 0.6
    ml_block_threshold: 0.8
    action_on_block: "block"
  jailbreak:
    regex_enabled: true
    ml_enabled: true
    ml_warn_threshold: 0.6
    ml_block_threshold: 0.8
    action_on_block: "block"
  data_exfil:
    regex_enabled: true
    ml_enabled: true
    ml_warn_threshold: 0.55
    ml_block_threshold: 0.75
    action_on_block: "block"
  pii:
    regex_enabled: true
    ml_enabled: true
    ml_warn_threshold: 0.5
    action_on_regex_hit: "redact"
    action_on_ml_only: "log"
  secrets:
    regex_enabled: true
    ml_enabled: true
    ml_warn_threshold: 0.5
    ml_block_threshold: 0.85
    action_on_regex_hit: "block_and_redact"
    action_on_ml_only: "log"

strajaguard:
  max_sessions: 2
  intra_threads: 4
  inter_threads: 1
